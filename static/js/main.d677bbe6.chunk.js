(this["webpackJsonpteams-tab"]=this["webpackJsonpteams-tab"]||[]).push([[0],{584:function(e,t,n){e.exports=n(714)},714:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(68),i=n.n(c),o=n(74),u=n(75),l=n(189),s=n(202),m=n(199),h=n(200),d=n(371),g=n(101),f=n(57);function p(){return f.settings.registerOnSaveHandler((function(e){f.settings.setSettings({contentUrl:window.location.origin,entityId:window.location.origin}),e.notifySuccess()})),f.settings.setValidityState(!0),r.a.createElement("h1",null,"Configure")}var v=n(180),E=n(179),y=n(64),k=n(164),b=n(120),I=n(66);function w(e){return r.a.createElement(k.a,{gap:"gap.medium",styles:{paddingLeft:"5px"}},e.icon&&r.a.createElement(b.a,{align:"center"},e.icon),r.a.createElement(b.a,null,r.a.createElement(I.a,{content:e.title,size:"large",weight:"bold"})))}var C=n(92),O=function(e){Object(s.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).menuWidth=void 0,a.menuWidth=e.menuWidth,a.state={menuItems:e.menuItems,currentKey:e.menuItems.length>0?e.menuItems[0].key:""},a}return Object(u.a)(n,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{content:this.renderMenu(),styles:{gridColumn:"span ".concat(this.menuWidth)}}),r.a.createElement(E.a,{content:this.renderContent(),styles:{gridColumn:"span ".concat(12-this.menuWidth)}}))}},{key:"renderMenu",value:function(){return r.a.createElement(C.a,{defaultActiveIndex:0,items:this.formatMenuItems(this.state.menuItems),vertical:!0,pointing:!0,styles:{width:"auto"},onActiveIndexChange:this.menuItemChanged.bind(this)})}},{key:"renderContent",value:function(){var e=this,t=this.state.menuItems.filter((function(t){return t.key===e.state.currentKey}));return 1!==t.length&&console.error("A single item was not found for content with key: ".concat(this.state.currentKey)),t[0].pageContent}},{key:"formatMenuItems",value:function(e){var t,n=[],a=Object(h.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.push({key:r.key,content:r.label,icon:r.icon})}}catch(c){a.e(c)}finally{a.f()}return n}},{key:"menuItemChanged",value:function(e,t){var n=t.activeIndex;t.items&&t.items[n]&&this.setState({currentKey:t.items[n].key})}}]),n}(r.a.Component);function S(){return r.a.createElement(v.a,{columns:"repeat(12, 1fr)"},r.a.createElement(E.a,{content:r.a.createElement(w,{title:"Our new Teams app",icon:r.a.createElement(y.TeamsIcon,null)}),styles:{gridColumn:"span 2"}}),r.a.createElement(E.a,{styles:{gridColumn:"span 10"}}),r.a.createElement(O,{menuWidth:2,menuItems:L}))}function T(){return r.a.createElement("button",{onClick:z.Login},"Click to log in")}function j(){return z.StartSignIn(),r.a.createElement("h1",null,"Starting sign in...")}function R(){return z.EndSignIn(),r.a.createElement("h1",null,"Ending sign in...")}var x=[{route:"/configure",component:r.a.createElement(p,null),authenticated:!1},{route:"/auth/login",component:r.a.createElement(T,null),authenticated:!1},{route:"/auth/signinstart",component:r.a.createElement(j,null),authenticated:!1},{route:"/auth/signinend",component:r.a.createElement(R,null),authenticated:!1},{route:"/",component:r.a.createElement(S,null),authenticated:!0}],L=[{key:"home",icon:r.a.createElement(y.GalleryIcon,null),label:"Home",pageContent:r.a.createElement("div",null,r.a.createElement("h1",null,"Home tab"),r.a.createElement("p",null,"Home tab content"))},{key:"other-content",icon:r.a.createElement(y.PresenterIcon,null),label:"Other Tab",pageContent:r.a.createElement("div",null,r.a.createElement("h1",null,"Some other content"),r.a.createElement("p",null,"Something else goes here"))}],U=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,null,[{key:"AuthenticatedRoutes",value:function(){return e.RenderRoutes(x)}},{key:"UnauthenticatedRoutes",value:function(){var t,n=x,a=Object(h.a)(n);try{for(a.s();!(t=a.n()).done;){var c=t.value;c.authenticated&&(c.component=r.a.createElement(T,null))}}catch(i){a.e(i)}finally{a.f()}return e.RenderRoutes(n)}},{key:"RenderRoutes",value:function(e){return r.a.createElement(d.a,null,r.a.createElement(g.c,null,e.map((function(e){return r.a.createElement(g.a,{path:e.route,exact:"/"===e.route},e.component)}))))}}]),e}(),P="contrast",A="dark",W="default",_={appId:Object({NODE_ENV:"production",PUBLIC_URL:"/msApp",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).APP_ID,cacheLocation:"localStorage",signInStartPage:"auth/signinstart",signInEndPage:"auth/signinend",authenticatedDomains:{"https://graph.microsoft.com":"https://graph.microsoft.com"}},D=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,null,[{key:"getTheme",value:function(e){switch(e=e||""){case A:return y.themes.teamsDark;case P:return y.themes.teamsHighContrast;case W:default:return y.themes.teams}}}]),e}(),H=n(162),K=n.n(H),F=n(292),M=n(374),q=new(n.n(M).a)({clientId:_.appId,redirectUri:"".concat(window.location.origin,"/").concat(_.signInEndPage),cacheLocation:_.cacheLocation,endpoints:_.authenticatedDomains,navigateToLoginRequestUrl:!1}),z=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,null,[{key:"IsUserLoggedIn",value:function(){var e=q.getCachedUser(),t=q.getCachedToken(_.appId);return!!e&&t.length>0}},{key:"Login",value:function(){var t=Object(F.a)(K.a.mark((function t(){var n;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="",t.prev=1,t.next=4,e.getAccessToken();case 4:n=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.error(t.t0);case 10:n.length>0&&window.location.replace(window.location.origin);case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(){return t.apply(this,arguments)}}()},{key:"StartSignIn",value:function(){q.clearCache(),q.login()}},{key:"EndSignIn",value:function(){q.isCallback(window.location.hash)&&(q.handleWindowCallback(window.location.hash),window.opener&&(q.getCachedUser()?q.acquireToken("https://graph.microsoft.com",(function(e,t){t?f.authentication.notifySuccess(t):e?f.authentication.notifyFailure(e):f.authentication.notifyFailure("UnexpectedFailure")})):microsoftTeams.authentication.notifyFailure(q.getLoginError())))}},{key:"getAccessToken",value:function(){var e=Object(F.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){f.authentication.authenticate({url:"".concat(window.location.origin,"/").concat(_.signInStartPage),width:600,height:535,successCallback:function(t){e(t)},failureCallback:function(e){t(e)}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),B=n(181),J=function(e){Object(s.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={theme:D.getTheme("default"),loggedIn:z.IsUserLoggedIn()},f.initialize(),f.registerOnThemeChangeHandler(a.updateTheme.bind(Object(l.a)(a))),f.getContext((function(e){a.updateTheme(e.theme)})),a}return Object(u.a)(n,[{key:"render",value:function(){return r.a.createElement(B.a,{theme:this.state.theme},this.state.loggedIn?r.a.createElement(U.AuthenticatedRoutes,null):r.a.createElement(U.UnauthenticatedRoutes,null))}},{key:"updateTheme",value:function(e){this.setState({theme:D.getTheme(e)})}}]),n}(r.a.Component);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root"))}},[[584,1,2]]]);
//# sourceMappingURL=main.d677bbe6.chunk.js.map